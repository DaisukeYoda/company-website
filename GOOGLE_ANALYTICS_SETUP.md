# Google Analytics 4 (GA4) 設定手順

## 1. Google Analytics 4 プロパティの作成

### 1.1 Google Analyticsにアクセス
1. [Google Analytics](https://analytics.google.com/)にアクセス
2. Googleアカウントでログイン

### 1.2 新しいプロパティの作成
1. 「管理」→「プロパティを作成」をクリック
2. プロパティ名: `Ludo Technologies`
3. タイムゾーン: `日本`
4. 通貨: `日本円（JPY）`

### 1.3 ビジネス情報の設定
1. 業種: `テクノロジー`
2. ビジネスの規模: `小規模（従業員数1-10人）`
3. 利用目的: `ウェブサイトまたはアプリのベースライン レポートを取得する`

## 2. データストリームの設定

### 2.1 ウェブストリームの作成
1. 「データストリーム」→「ストリームを追加」→「ウェブ」
2. ウェブサイトのURL: `https://ludo-tech.org`
3. ストリーム名: `Ludo Technologies Website`

### 2.2 測定IDの取得
- データストリーム詳細画面で **測定ID（G-XXXXXXXXXX）** をコピー

## 3. 環境変数の設定

### 3.1 .envファイルの作成
```bash
# .env ファイルを作成（既存の .env.example をコピー）
cp .env.example .env
```

### 3.2 測定IDの設定
```env
# .env ファイルに測定IDを設定
PUBLIC_GA_MEASUREMENT_ID=G-あなたの測定ID
```

## 4. 追跡可能なイベント

### 4.1 自動追跡イベント
- **ページビュー**: 全ページで自動追跡
- **スクロール深度**: 25%, 50%, 75%, 90%で追跡
- **外部リンククリック**: 自動検出・追跡
- **メールリンククリック**: mailto:リンクの追跡
- **ページ滞在時間**: 30秒以上の場合に追跡

### 4.2 フォーム関連イベント
- **form_submit**: お問い合わせフォーム送信
- **contact_form_success**: 送信成功
- **contact_form_error**: 送信エラー（サーバーエラー/ネットワークエラー）

### 4.3 カスタムディメンション
- **dimension1**: page_type（ページタイプ）
- **dimension2**: user_type（ユーザータイプ）

## 5. Google Analytics 管理画面での確認

### 5.1 リアルタイムレポート
1. 「レポート」→「リアルタイム」で現在のアクセスを確認
2. サイトにアクセスして数値が増加することを確認

### 5.2 イベント設定
1. 「設定」→「イベント」で追跡イベントを確認
2. カスタムイベントが正しく記録されているかチェック

### 5.3 目標設定（推奨）
1. 「設定」→「コンバージョン」→「新しいコンバージョンイベント」
2. 以下のイベントをコンバージョンとして設定:
   - `contact_form_success`（お問い合わせ完了）
   - `email_click`（メールクリック）

## 6. カスタムイベントの追加方法

### 6.1 JavaScript での追跡
```javascript
// カスタムイベントの送信例
if (typeof window.trackEvent === 'function') {
  window.trackEvent('button_click', {
    button_name: 'cta_button',
    section: 'hero',
    page_location: window.location.href
  });
}
```

### 6.2 フォーム送信の追跡
```javascript
// フォーム送信時の追跡
window.trackFormSubmission('newsletter', 'signup_form');
```

## 7. プライバシー設定

### 7.1 IP アドレスの匿名化
- GA4では自動的にIPアドレスが匿名化されます

### 7.2 データ保持期間
1. 「管理」→「データ設定」→「データ保持」
2. 推奨設定: `14ヶ月`

## 8. レポート活用

### 8.1 重要な指標
- **ページビュー数**: 最も閲覧されているページ
- **ユーザー数**: サイト訪問者数
- **セッション時間**: ユーザーの滞在時間
- **コンバージョン率**: お問い合わせ完了率

### 8.2 おすすめレポート
- 「ライフサイクル」→「集客」→「トラフィック獲得」
- 「ライフサイクル」→「エンゲージメント」→「ページとスクリーン」
- 「ライフサイクル」→「収益化」→「コンバージョン」

## 9. トラブルシューティング

### 9.1 データが表示されない場合
1. 測定IDが正しく設定されているか確認
2. ブラウザの開発者ツールでエラーをチェック
3. リアルタイムレポートでデータが送信されているか確認

### 9.2 イベントが記録されない場合
1. JavaScriptコンソールでエラーをチェック
2. `gtag` 関数が読み込まれているか確認
3. カスタムイベント関数が定義されているか確認

## 10. 本番環境デプロイ時の注意点

1. **環境変数の設定**: Vercel等に `PUBLIC_GA_MEASUREMENT_ID` を設定
2. **ドメイン設定**: GA4管理画面でドメインを `ludo-tech.org` に更新
3. **テスト**: 本番環境でイベントが正しく送信されるかテスト